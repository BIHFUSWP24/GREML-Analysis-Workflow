configfile: "/sc-projects/sc-proj-dh-ukb-intergenics/analysis/development/lesi11/code/GREML/workflow/config.yaml"
# include: "rules/greml.smk"
include: "rules/dimension_reduction.smk"
include: "rules/visualization.smk"


rule test:
    input:
        expand('test_output/{i}.txt', i=range(100))

rule test2:
    output: "test_output/{num}.txt"
    shell: """
        echo {wildcards.num} > {output}
        """


rule all:
  input:
    f"{config['results_directory']}/ukb22828_c22_b0_v3/ukb22828_c22_b0_v3_filtered_heatmap.png",
    # f"{config['results_directory']}/100k_snp_chr1/PCA/868dims/pearson_heatmap.png",
    # f"{config['results_directory']}/100k_snp_chr1/PCA/868dims/spearman_heatmap.png",
    # f"{config['build_directory']}/100k_snp_chr1/kernelPCA/868dims/spearman.grm",
    # f"{config['build_directory']}/100k_snp_chr1/kernelPCA/868dims/pearson.grm",
    # expand("{build_directory}/100k_snp_chr1/UMAP/{dims}dims{neighbors}nn.h5ad", build_directory=config['build_directory'], dims=[868,1254,1932,8211], neighbors=[15,30]),
    # expand("{build_directory}/100k_snp_chr1/tSNE/{dims}dims{pxt}pxt.h5ad", build_directory=config['build_directory'], dims=[868,1254,1932,8211], pxt=[35,50]),
    # expand("{build_directory}/100k_snp_chr1/kernelPCA/{dims}dims.h5ad", build_directory=config['build_directory'], dims=[868,1254,1932,8211]),
    # expand("{build_directory}/100k_snp_chr1/PCA/{dims}dims.h5ad", build_directory=config['build_directory'], dims=[868,1254,1932,8211]),
    # expand("{results_directory}/100k_snp_chr1/PCA/{dims}dims/{distance_method}_{plot_method}.png", results_directory=config['results_directory'], dims=[868,1254,1932,8211], distance_method=config['distance_methods'], plot_method=config['plot_methods']),
    # f"{config['build_directory']}/100k_snp_chr1_pca_10dims.h5ad"


'''
snakemake \
    --jobs 25 \
    --latency-wait 30 \
    --default-resources mem_mb=2000 \
    --cluster '
        sbatch \
            --partition=compute \
            --time=24:00:00 \
            --mem={resources.mem_mb} \
            --cpus-per-task=4 \
            --output=/sc-projects/sc-proj-dh-ukb-intergenics/analysis/development/lesi11/code/GREML/workflow/logs/{rule}.{wildcards}.out \
            --error=/sc-projects/sc-proj-dh-ukb-intergenics/analysis/development/lesi11/code/GREML/workflow/logs/{rule}.{wildcards}.err '
'''